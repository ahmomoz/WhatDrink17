import"./bootstrap.min-feac71ab.js";const u=new URLSearchParams(window.location.search),n=u.get("token");console.log(n);n?(console.log("找到 token:",n),axios.get("https://authbridge.onrender.com/user",{headers:{Authorization:n}}).then(t=>{if(t){const o=t.data.email;a(o,n)}}).catch(t=>{console.log(t)})):console.log("未找到指定的 token");const d=sessionStorage.getItem("jwtToken");function m(){return d?(console.log("有權限: 找到 Token"),!0):!1}m();document.getElementById("loginForm").addEventListener("submit",function(t){t.preventDefault();const o=document.getElementById("logInEmail").value,e=document.getElementById("logInPassword").value;a(o,e)});async function a(t,o){try{const e=await axios.post("https://drinkpicker-nclv.onrender.com/login",{email:t,password:o});console.log(e.data);const s=e.data.accessToken,r=e.data.user.email,c=e.data.user.id,i=e.data.user.nickname,l=e.data.user.picture;s?(console.log("登入成功",e.data),sessionStorage.setItem("jwtToken",s),sessionStorage.setItem("user_email",r),sessionStorage.setItem("user_id",c),sessionStorage.setItem("user_nickname",i),sessionStorage.setItem("user_picture",l),g()):alert("登入失敗，請檢查帳號或密碼")}catch(e){console.error("登入錯誤",e),alert("登入失敗，請檢查帳號或密碼")}}function g(){window.location.href="index.html"}
