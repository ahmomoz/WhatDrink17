import"./bootstrap.min-feac71ab.js";const l="https://authbridge.onrender.com/user",u="https://drinkpicker-nclv.onrender.com/login",d="index.html",s=new URLSearchParams(window.location.search).get("token");async function m(e){try{const o=await a(l,"GET",e);o&&o.data.email?(console.log("用戶身份驗證成功:",o.data.email),i(o.data.email,e)):console.log("用戶身份驗證失敗")}catch(o){console.error("身份驗證過程中發生錯誤:",o)}}async function i(e,o){console.log(!0);try{const n=await a(u,"POST",null,{email:e,password:o});n.status===200&&n.data.accessToken?(console.log("登入成功",n.data),g(n.data),f()):r()}catch(n){console.error("登入錯誤",n),r()}}function g(e){sessionStorage.setItem("jwtToken",e.accessToken),sessionStorage.setItem("user_email",e.user.email),sessionStorage.setItem("user_id",e.user.id),sessionStorage.setItem("user_nickname",e.user.nickname),sessionStorage.setItem("user_picture",e.user.picture)}function r(){alert("登入失敗，請檢查帳號或密碼")}function f(){window.location.href=d}async function a(e,o,t="",n={}){const c={method:o,url:e,headers:{Authorization:t},data:n};return await axios(c)}function h(){return sessionStorage.getItem("jwtToken")?(console.log("找到 Session Token"),!0):(console.log("未找到 Session Token"),!1)}document.getElementById("loginForm").addEventListener("submit",function(e){e.preventDefault();const o=document.getElementById("logInEmail").value,t=document.getElementById("logInPassword").value;i(o,t)});s?(console.log("找到 JWT_token",s),m(s)):console.log("未找到 JWT_token");h();
