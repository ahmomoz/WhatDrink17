import"./bootstrap.min-66c8f441.js";const l=new URLSearchParams(window.location.search),n=l.get("token");console.log(n);n?(console.log("找到 token:",n),axios.get("https://authbridge.onrender.com/user",{headers:{Authorization:n}}).then(o=>{if(o){const t=o.data.email;a(t,n)}}).catch(o=>{console.log(o)})):console.log("未找到指定的 token");const d=sessionStorage.getItem("jwtToken");function m(){return d?(console.log("有權限: 找到 Token"),redirectToMember(),!0):!1}m();document.getElementById("loginForm").addEventListener("submit",function(o){o.preventDefault();const t=document.getElementById("logInEmail").value,e=document.getElementById("logInPassword").value;a(t,e)});async function a(o,t){try{const e=await axios.post("https://drinkpicker-nclv.onrender.com/login",{email:o,password:t});console.log(e.data);const s=e.data.accessToken,r=e.data.user.email,c=e.data.user.id,i=e.data.user.nickname;s?(console.log("登入成功",e.data),sessionStorage.setItem("jwtToken",s),sessionStorage.setItem("user_email",r),sessionStorage.setItem("user_id",c),sessionStorage.setItem("user_nickname",i),u()):alert("登入失敗，請檢查帳號或密碼")}catch(e){console.error("登入錯誤",e),alert("登入失敗，請檢查帳號或密碼")}}function u(){window.location.href="index.html"}
